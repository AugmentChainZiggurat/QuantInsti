import pandas as pd
import numpy as np

path = ('C:\\Dados\WIN$D_Daily.csv')
df = pd.read_csv(path,delimiter='\t')

df.head()

print (df.count()) #df count retorna a quantidade de numeros nao nulos
print (df['<OPEN>'].count()) #especifico de uma coluna

print (df['<CLOSE>'].min()) #retorna o menor valor da coluna
print (df.min())

print (df.max())
print (df['<OPEN>'].max())

print (df['<VOL>'].sum()) #soma
print (df['<LOW>'].diff()) #retorna a diferença dos valores anteriores
print (df['<CLOSE>'].pct_change()) #retorna a variacao em % do dia anterior

#mostrar a variacao media do preco de fechamento
import matplotlib.pyplot as plt
import seaborn as sns

plt.figure(figsize=(20,10))
plt.ylabel('Retorno em %')
df['<CLOSE>'].pct_change().plot()
plt.show()

df['<OPEN>'].var() #variancia do ativo
df['<OPEN>'].std() #desvio padrao do ativo

#calculando a media movel do ativo
df['<CLOSE>'].rolling(window=20).mean().plot()

#plotando a media movel junto no grafico de preço
import matplotlib.pyplot as plt
import seaborn as sns

plt.figure(figsize=(20,10))
plt.ylabel('Closing Price')


df['<CLOSE>'].rolling(window=20).mean().plot()
df["<CLOSE>"].plot()

plt.show()

petr4 = pd.read_csv('C:\\Dados\\PETR4_Daily.csv',delimiter='\t')
petr3 = pd.read_csv('C:\\Dados\\PETR3_Daily.csv',delimiter='\t')

#covariancia/correlação dos ativos
petr4["<CLOSE>"].cov(petr3["<CLOSE>"])
petr4["<CLOSE>"].corr(petr3["<CLOSE>"])

#distribuição normal
import seaborn as sns

sns.set(color_codes = True)
sns.distplot(df['<CLOSE>'])
